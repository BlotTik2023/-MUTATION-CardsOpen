<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ö–æ–ª–ª–µ–∫—Ü–∏–æ–Ω–Ω—ã–µ –∫–∞—Ä—Ç–æ—á–∫–∏</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            background-color: #f0f0f0;
            margin: 0;
            padding: 20px;
        }
        
        .account-value {
            font-size: 24px;
            font-weight: bold;
            margin: 20px 0;
            color: #000000;
            background-color: rgba(233, 233, 233, 1);
            padding: 10px;
            border-radius: 10px;
            display: inline-block;
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è —Ä–∞–Ω–≥–æ–≤ –∫–æ–ª–ª–µ–∫—Ü–∏–æ–Ω–µ—Ä–∞ */
        .account-rank {
            font-size: 20px;
            font-weight: bold;
            margin: 10px 0;
            padding: 8px 15px;
            border-radius: 20px;
            display: inline-block;
            background-color: #e9e9e9;
            transition: all 0.3s;
        }
        
        /* –¶–≤–µ—Ç–∞ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ä–∞–Ω–≥–æ–≤ */
        .rank-beginner { color: #666666; }
        .rank-experienced { color: #2e7d32; }
        .rank-professional { color: #1565c0; }
        .rank-master { color: #6a1b9a; }
        .rank-a { color: #d32f2f; }
        .rank-s { color: #ff9800; }
        .rank-ss { color: #ff5722; }
        .rank-sss { color: #c2185b; }
        .rank-legendary { 
            color: white; 
            background: linear-gradient(90deg, #4a148c, #e91e63); 
            box-shadow: 0 0 10px rgba(233, 30, 99, 0.7);
        }
        
        .player-counters {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .player-counter {
            background-color: rgba(233, 233, 233, 1);
            padding: 10px 20px;
            border-radius: 10px;
            font-weight: bold;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .online-counter { color: #4CAF50; }
        .total-counter { color: #2196F3; }
        
        button {
            padding: 10px 20px;
            font-size: 16px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin: 0 10px 20px;
        }
        
        button:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
        }
        
        button:hover:not(:disabled) {
            background-color: #45a049;
        }
        
        .reset-btn {
            background-color: #f44336;
        }
        
        .reset-btn:hover {
            background-color: #d32f2f;
        }
        
        .cooldown {
            position: fixed;
            top: 10px;
            right: 10px;
            background-color: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 14px;
            z-index: 10;
            display: none;
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 100;
            justify-content: center;
            align-items: center;
        }
        
        .card {
            width: 300px;
            height: 400px;
            border-radius: 15px;
            padding: 20px;
            box-sizing: border-box;
            position: relative;
            color: white;
            font-weight: bold;
            text-shadow: 1px 1px 2px black;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            transform-style: preserve-3d;
            transition: transform 0.6s;
        }
        
        .card.flipped {
            transform: rotateY(180deg);
        }
        
        .card-front, .card-back {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            border-radius: 15px;
            padding: 20px;
            box-sizing: border-box;
        }
        
        .card-front {
            background-color: #333;
        }
        
        .card-back {
            background-color: inherit;
            transform: rotateY(180deg);
        }
        
        .card-name {
            font-size: 48px;
            margin-bottom: 10px;
            font-weight: 900;
        }
        
        .card-rarity {
            font-size: 20px;
            margin-bottom: 5px;
        }
        
        .card-chance {
            font-size: 16px;
        }
        
        .mutation-label {
            position: absolute;
            bottom: 10px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 12px;
            background-color: rgba(0, 0, 0, 0.7);
            padding: 2px 8px;
            border-radius: 10px;
        }
        
        .shiny-label { color: white; }
        .golden-label { color: gold; }
        .void-label {
            color: #fff;
            background-color: #000;
        }
        
        .main-container {
            display: flex;
            max-width: 1200px;
            margin: 0 auto;
            width: 100%;
        }
        
        .left-column {
            width: 250px;
            margin-right: 20px;
        }
        
        .right-column {
            width: 250px;
            margin-left: 20px;
        }
        
        .chat-container {
            background-color: #fff;
            border-radius: 10px;
            padding: 15px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
            height: 200px;
            display: flex;
            flex-direction: column;
        }
        
        .trade-container {
            background-color: #fff;
            border-radius: 10px;
            padding: 15px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
            height: 400px;
            display: flex;
            flex-direction: column;
        }
        
        .trade-header {
            font-weight: bold;
            margin-bottom: 10px;
            font-size: 18px;
            text-align: center;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
        }
        
        .trade-offers {
            flex-grow: 1;
            overflow-y: auto;
            margin-bottom: 10px;
        }
        
        .trade-offer {
            padding: 10px;
            margin-bottom: 10px;
            background-color: #f9f9f9;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        
        .trade-offer:hover {
            background-color: #f0f0f0;
        }
        
        .trade-create {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .trade-select {
            width: 100%;
            padding: 8px;
            border-radius: 5px;
            border: 1px solid #ddd;
        }
        
        .trade-button {
            padding: 8px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        
        .trade-button:hover {
            background-color: #45a049;
        }
        
        .chat-header {
            font-weight: bold;
            margin-bottom: 10px;
            font-size: 18px;
            text-align: center;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
        }
        
        .chat-messages {
            flex-grow: 1;
            overflow-y: auto;
            display: flex;
            flex-direction: column-reverse;
            padding: 5px;
        }
        
        .message {
            margin-bottom: 8px;
            padding: 5px 8px;
            border-radius: 5px;
            background-color: #f1f1f1;
            word-break: break-word;
            font-size: 13px;
            line-height: 1.3;
        }
        
        .golden-message {
            color: goldenrod;
            font-weight: bold;
        }
        
        .ultra-legendary-message {
            animation: rainbow-text 3s infinite linear;
            font-weight: bold;
        }
        
        @keyframes rainbow-text {
            0% { color: red; }
            14% { color: orange; }
            28% { color: yellow; }
            42% { color: green; }
            56% { color: blue; }
            70% { color: indigo; }
            84% { color: violet; }
            100% { color: red; }
        }
        
        .sidebar {
            background-color: #fff;
            border-radius: 10px;
            padding: 15px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            align-self: flex-start;
            max-height: 60vh;
            overflow-y: auto;
        }
        
        .sidebar-title {
            font-weight: bold;
            margin-bottom: 15px;
            font-size: 18px;
            text-align: center;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
        }
        
        .card-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .card-list-item {
            display: flex;
            align-items: center;
            padding: 8px;
            border-radius: 5px;
            background-color: #f9f9f9;
            transition: background-color 0.2s;
        }
        
        .card-list-item:hover {
            background-color: #f0f0f0;
        }
        
        .card-preview {
            width: 40px;
            height: 40px;
            border-radius: 5px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-weight: bold;
            font-size: 18px;
            color: white;
            margin-right: 10px;
            flex-shrink: 0;
        }
        
        .card-info {
            flex-grow: 1;
            text-align: left;
        }
        
        .card-name-small {
            font-weight: bold;
            font-size: 14px;
        }
        
        .card-rarity-small {
            font-size: 12px;
            color: #666;
        }
        
        .card-count {
            font-weight: bold;
            font-size: 14px;
            margin-left: 10px;
            min-width: 30px;
            text-align: right;
        }
        
        .content {
            flex-grow: 1;
        }
        
        .collection-container {
            max-width: 900px;
            margin: 30px auto 0;
            overflow-x: auto;
        }
        
        .collection {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 15px;
        }
        
        .card-group {
            position: relative;
            width: 150px;
            height: 200px;
            margin: 5px;
        }
        
        .card-count {
            position: absolute;
            top: 0;
            left: 0;
            transform: translate(-25%, 35%);
            background-color: rgba(0, 0, 0, 0.7);
            color: white;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            font-size: 14px;
            z-index: 2;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        .stacked-card {
            position: absolute;
            width: 150px;
            height: 200px;
            border-radius: 8px;
            padding: 10px;
            box-sizing: border-box;
            color: white;
            font-weight: bold;
            text-shadow: 1px 1px 1px black;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            font-size: 24px;
            transition: transform 0.3s;
        }
        
        .stacked-card:hover {
            transform: scale(1.05) translateY(-5px);
            z-index: 3;
        }
        
        .stacked-card .card-name {
            font-size: 36px;
            margin-bottom: 5px;
            font-weight: 900;
        }
        
        .stacked-card .card-rarity {
            font-size: 14px;
            margin-bottom: 3px;
        }
        
        .stacked-card .card-chance {
            font-size: 12px;
        }
        
        .stacked-card.pos-0 { transform: rotate(-2deg); z-index: 1; }
        .stacked-card.pos-1 { transform: rotate(1deg) translateY(-3px); z-index: 2; }
        .stacked-card.pos-2 { transform: rotate(3deg) translateY(-6px); z-index: 3; }
        
        .mutation-section {
            margin-top: 20px;
            width: 100%;
        }
        
        .mutation-section h3 {
            text-align: center;
            background-color: #e9e9e9;
            padding: 5px;
            border-radius: 5px;
            margin-bottom: 10px;
        }
        
        .normal-cards .stacked-card { border: 2px solid #333; }
        .shiny-cards .stacked-card { border: 2px solid #ffffff; }
        .golden-cards .stacked-card { border: 2px solid gold; }
        .ultra-legendary-cards .stacked-card { animation: rainbow-border 3s infinite linear; }
        
        .rarity-info {
            margin: 20px auto;
            padding: 10px;
            background-color: #e9e9e9;
            border-radius: 5px;
            max-width: 800px;
        }
        
        .big-pack-modal-content {
            position: relative;
            width: 90%;
            max-width: 900px;
            background-color: rgba(0, 0, 0, 0.8);
            padding: 20px;
            border-radius: 15px;
            max-height: 90vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }
        
        .multi-card-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 10px;
            max-width: 900px;
            margin: 0 auto;
            max-height: 70vh;
            overflow-y: auto;
            padding: 10px;
        }
        
        .multi-card {
            width: 180px;
            height: 240px;
            border-radius: 10px;
            padding: 15px;
            box-sizing: border-box;
            color: white;
            font-weight: bold;
            text-shadow: 1px 1px 1px black;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            font-size: 24px;
            transform-style: preserve-3d;
            transition: transform 0.6s;
            position: relative;
        }
        
        .multi-card-front, .multi-card-back {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            border-radius: 10px;
            padding: 15px;
            box-sizing: border-box;
        }
        
        .multi-card-front {
            background-color: #333;
            transform: rotateY(0deg);
        }
        
        .multi-card-back {
            background-color: inherit;
            transform: rotateY(180deg);
        }
        
        .multi-card.flipped {
            transform: rotateY(180deg);
        }
        
        .multi-card .card-name {
            font-size: 36px;
            margin-bottom: 5px;
            font-weight: 900;
        }
        
        .multi-card .card-rarity {
            font-size: 16px;
            margin-bottom: 3px;
        }
        
        .multi-card .card-chance {
            font-size: 12px;
        }
        
        .pack-title {
            color: white;
            text-shadow: 1px 1px 2px black;
            margin-bottom: 20px;
            font-size: 24px;
        }
        
        .scroll-indicator {
            position: absolute;
            bottom: 10px;
            left: 50%;
            transform: translateX(-50%);
            color: white;
            font-size: 14px;
            background-color: rgba(0, 0, 0, 0.7);
            padding: 5px 10px;
            border-radius: 20px;
            opacity: 0;
            transition: opacity 0.3s;
        }
        
        .big-pack-modal-content:hover .scroll-indicator {
            opacity: 1;
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è –º—É—Ç–∞—Ü–∏–π */
        .shiny {
            animation: shine 2s infinite;
        }
        
        @keyframes shine {
            0% { filter: brightness(1); }
            50% { filter: brightness(1.3); }
            100% { filter: brightness(1); }
        }
        
        .golden {
            border: 5px solid gold;
            box-shadow: 0 0 20px gold;
        }
        
        .ultra-legendary {
            animation: rainbow-border 3s infinite linear;
        }
        
        .void {
            border: 5px solid #000;
            box-shadow: 0 0 20px #000, inset 0 0 10px #666;
        }
        
        @keyframes rainbow-border {
            0% { box-shadow: 0 0 20px red; border: 5px solid red; }
            14% { box-shadow: 0 0 20px orange; border: 5px solid orange; }
            28% { box-shadow: 0 0 20px yellow; border: 5px solid yellow; }
            42% { box-shadow: 0 0 20px green; border: 5px solid green; }
            56% { box-shadow: 0 0 20px blue; border: 5px solid blue; }
            70% { box-shadow: 0 0 20px indigo; border: 5px solid indigo; }
            84% { box-shadow: 0 0 20px violet; border: 5px solid violet; }
            100% { box-shadow: 0 0 20px red; border: 5px solid red; }
        }
        
        .shiny-preview {
            border: 2px solid white;
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.7);
        }
        
        .golden-preview {
            border: 2px solid gold;
            box-shadow: 0 0 10px gold;
        }
        
        .ultra-legendary-preview {
            animation: rainbow-border-small 3s infinite linear;
        }
        
        .void-preview {
            border: 2px solid #000;
            box-shadow: 0 0 10px #000, inset 0 0 5px #666;
        }
        
        @keyframes rainbow-border-small {
            0% { box-shadow: 0 0 5px red; border: 2px solid red; }
            14% { box-shadow: 0 0 5px orange; border: 2px solid orange; }
            28% { box-shadow: 0 0 5px yellow; border: 2px solid yellow; }
            42% { box-shadow: 0 0 5px green; border: 2px solid green; }
            56% { box-shadow: 0 0 5px blue; border: 2px solid blue; }
            70% { box-shadow: 0 0 5px indigo; border: 2px solid indigo; }
            84% { box-shadow: 0 0 5px violet; border: 2px solid violet; }
            100% { box-shadow: 0 0 5px red; border: 2px solid red; }
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è —Ñ–æ—Ä–º—ã –≤—Ö–æ–¥–∞ */
        .login-modal {
            display: flex;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        
        .login-form {
            background-color: white;
            padding: 20px;
            border-radius: 10px;
            width: 300px;
            text-align: center;
        }
        
        .login-form h2 {
            margin-top: 0;
        }
        
        .login-form input {
            width: 100%;
            padding: 10px;
            margin: 10px 0;
            box-sizing: border-box;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        
        .login-form button {
            width: 100%;
            padding: 10px;
            margin-top: 10px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        
        .login-form button:hover {
            background-color: #45a049;
        }
        
        .notification {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background-color: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 10px 20px;
            border-radius: 5px;
            z-index: 1001;
            display: none;
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ –±—É—Å—Ç–∞—Ö */
        .boost-notification {
            position: fixed;
            top: 70px;
            left: 50%;
            transform: translateX(-50%);
            background-color: rgba(0, 0, 0, 0.8);
            color: #fff;
            padding: 10px 20px;
            border-radius: 5px;
            z-index: 1002;
            display: flex;
            align-items: center;
            box-shadow: 0 0 10px rgba(255, 215, 0, 0.7);
            animation: pulse 2s infinite;
        }
        
        .boost-notification .icon {
            margin-right: 10px;
            font-size: 20px;
        }
        
        @keyframes pulse {
            0% { box-shadow: 0 0 5px rgba(255, 215, 0, 0.7); }
            50% { box-shadow: 0 0 20px rgba(255, 215, 0, 0.7); }
            100% { box-shadow: 0 0 5px rgba(255, 215, 0, 0.7); }
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è –º–µ–≥–∞ –ø–∞–∫–∞ */
        .mega-pack-modal-content {
            position: relative;
            width: 95%;
            max-width: 1200px;
            background-color: rgba(0, 0, 0, 0.9);
            padding: 20px;
            border-radius: 15px;
            max-height: 90vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }
        
        .mega-card-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 8px;
            max-width: 1200px;
            margin: 0 auto;
            max-height: 70vh;
            overflow-y: auto;
            padding: 10px;
        }
        
        .mega-card {
            width: 120px;
            height: 160px;
            border-radius: 8px;
            padding: 10px;
            box-sizing: border-box;
            color: white;
            font-weight: bold;
            text-shadow: 1px 1px 1px black;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            font-size: 18px;
            transform-style: preserve-3d;
            transition: transform 0.6s;
            position: relative;
        }
        
        .mega-card-front, .mega-card-back {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            border-radius: 8px;
            padding: 10px;
            box-sizing: border-box;
        }
        
        .mega-card-front {
            background-color: #333;
            transform: rotateY(0deg);
        }
        
        .mega-card-back {
            background-color: inherit;
            transform: rotateY(180deg);
        }
        
        .mega-card.flipped {
            transform: rotateY(180deg);
        }
        
        .mega-card .card-name {
            font-size: 24px;
            margin-bottom: 3px;
            font-weight: 900;
        }
        
        .mega-card .card-rarity {
            font-size: 12px;
            margin-bottom: 2px;
        }
        
        .mega-card .card-chance {
            font-size: 10px;
        }
        
        .mega-pack-title {
            color: gold;
            text-shadow: 1px 1px 2px black;
            margin-bottom: 20px;
            font-size: 28px;
            animation: shine 2s infinite;
        }
        
        .mega-pack-timer {
            color: white;
            font-size: 16px;
            margin-bottom: 15px;
        }
    </style>
</head>
<body>
    <div id="loginModal" class="login-modal">
        <div class="login-form">
            <h2>–í—Ö–æ–¥ –≤ –∏–≥—Ä—É</h2>
            <p>–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è –¥–ª—è –∏–≥—Ä—ã</p>
            <input type="text" id="playerNameInput" placeholder="–í–∞—à–µ –∏–º—è" maxlength="20">
            <button id="loginButton">–í–æ–π—Ç–∏</button>
        </div>
    </div>
    
    <div id="notification" class="notification"></div>
    
    <h1>–ö–æ–ª–ª–µ–∫—Ü–∏–æ–Ω–Ω—ã–µ –∫–∞—Ä—Ç–æ—á–∫–∏</h1>
    <div class="account-value">–¶–µ–Ω–Ω–æ—Å—Ç—å –∞–∫–∫–∞—É–Ω—Ç–∞: <span id="accountValue">0</span></div>
    <div id="accountRank" class="account-rank rank-beginner">–Ω–∞—á–∏–Ω–∞—é—â–∏–π –∫–æ–ª–ª–µ–∫—Ü–∏–æ–Ω–µ—Ä</div>
    <div class="player-counters">
        <div class="player-counter online-counter">–ò–≥—Ä–æ–∫–æ–≤ –æ–Ω–ª–∞–π–Ω: <span id="onlinePlayers">0</span></div>
        <div class="player-counter total-counter">–í—Å–µ–≥–æ –ø–æ—Å–µ—Ç–∏—Ç–µ–ª–µ–π: <span id="totalPlayers">0</span></div>
    </div>
    
    <div>
        <button id="buyPack">–ö—É–ø–∏—Ç—å –æ–±—ã—á–Ω—ã–π –ø–∞–∫ (1 –∫–∞—Ä—Ç–∞)</button>
        <button id="buyBigPack">–ö—É–ø–∏—Ç—å –±–æ–ª—å—à–æ–π –ø–∞–∫ (5-7 –∫–∞—Ä—Ç)</button>
        <button id="buyMegaPack">–ú–µ–≥–∞ –ø–∞–∫ (100 –∫–∞—Ä—Ç)</button>
        <button id="resetCollection" class="reset-btn">–°–±—Ä–æ—Å–∏—Ç—å –∫–æ–ª–ª–µ–∫—Ü–∏—é</button>
    </div>
    
    <div id="cooldown" class="cooldown" style="display: none;"></div>
    <div id="megaPackTimer" class="cooldown" style="display: none; top: 50px;"></div>
    
    <div class="rarity-info">
        <h3>–®–∞–Ω—Å—ã –≤—ã–ø–∞–¥–µ–Ω–∏—è (–æ—Ç —Å–∞–º—ã—Ö —á–∞—Å—Ç—ã—Ö –∫ —Å–∞–º—ã–º —Ä–µ–¥–∫–∏–º):</h3>
        <div id="rarityChances"></div>
        <h3>–ú—É—Ç–∞—Ü–∏–∏ –∫–∞—Ä—Ç:</h3>
        <div>–ë–ª–µ—Å—Ç—è—â–∞—è: 10% —à–∞–Ω—Å (–∫–∞—Ä—Ç–∞ –ø–µ—Ä–µ–ª–∏–≤–∞–µ—Ç—Å—è)</div>
        <div>–ó–æ–ª–æ—Ç–∞—è: 1.25% —à–∞–Ω—Å (–∑–æ–ª–æ—Ç–∞—è –æ–±–≤–æ–¥–∫–∞)</div>
        <div>–£–ª—å—Ç—Ä–∞–ª–µ–≥–µ–Ω–¥–∞—Ä–Ω–∞—è: 0.1% —à–∞–Ω—Å (—Ä–∞–¥—É–∂–Ω–∞—è –æ–±–≤–æ–¥–∫–∞)</div>
        <div>–ü—É—Å—Ç–æ—Ç–Ω–∞—è: 0.0125% —à–∞–Ω—Å (—á—ë—Ä–Ω–æ–µ —Å–≤–µ—á–µ–Ω–∏–µ, –Ω–µ–ª—å–∑—è –æ–±–º–µ–Ω–∏–≤–∞—Ç—å)</div>
    </div>
    
    <div class="main-container">
        <div class="left-column">
            <div class="chat-container">
                <div class="chat-header">–ß–∞—Ç –∏–≥—Ä—ã</div>
                <div id="chatMessages" class="chat-messages"></div>
            </div>
            
            <div class="sidebar">
                <div class="sidebar-title">–í–∞—à–∞ –∫–æ–ª–ª–µ–∫—Ü–∏—è</div>
                <div id="sidebarCardList" class="card-list"></div>
            </div>
        </div>
        
        <div class="content">
            <div id="cardModal" class="modal">
                <div class="modal-content">
                    <div id="newCard" class="card">
                        <div class="card-front">–û—Ç–∫—Ä—ã–≤–∞–µ–º –∫–∞—Ä—Ç—É...</div>
                        <div class="card-back">
                            <div class="card-name"></div>
                            <div class="card-rarity"></div>
                            <div class="card-chance"></div>
                            <div class="mutation-label"></div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div id="bigPackModal" class="modal">
                <div class="big-pack-modal-content">
                    <h2 class="pack-title">–ë–æ–ª—å—à–æ–π –ø–∞–∫ –∫–∞—Ä—Ç</h2>
                    <div id="multiCardContainer" class="multi-card-container"></div>
                    <div class="scroll-indicator">–ü—Ä–æ–∫—Ä—É—Ç–∏—Ç–µ –≤–Ω–∏–∑, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å –≤—Å–µ –∫–∞—Ä—Ç—ã</div>
                </div>
            </div>
            
            <div id="megaPackModal" class="modal">
                <div class="mega-pack-modal-content">
                    <h2 class="mega-pack-title">‚ö° –ú–ï–ì–ê –ü–ê–ö ‚ö°</h2>
                    <div class="mega-pack-timer">–°–ª–µ–¥—É—é—â–∏–π –º–µ–≥–∞ –ø–∞–∫ —á–µ—Ä–µ–∑: <span id="nextMegaPackTime">25:00:00</span></div>
                    <div id="megaCardContainer" class="mega-card-container"></div>
                    <div class="scroll-indicator">–ü—Ä–æ–∫—Ä—É—Ç–∏—Ç–µ –≤–Ω–∏–∑, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å –≤—Å–µ –∫–∞—Ä—Ç—ã</div>
                </div>
            </div>
            
            <h2>–í–∞—à–∞ –∫–æ–ª–ª–µ–∫—Ü–∏—è</h2>
            <div class="collection-container">
                <div id="collection" class="collection">
                    <div class="mutation-section ultra-legendary-cards">
                        <h3>–£–ª—å—Ç—Ä–∞–ª–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–µ –∫–∞—Ä—Ç—ã</h3>
                        <div id="ultraLegendaryCards" class="collection"></div>
                    </div>
                    <div class="mutation-section golden-cards">
                        <h3>–ó–æ–ª–æ—Ç—ã–µ –∫–∞—Ä—Ç—ã</h3>
                        <div id="goldenCards" class="collection"></div>
                    </div>
                    <div class="mutation-section shiny-cards">
                        <h3>–ë–ª–µ—Å—Ç—è—â–∏–µ –∫–∞—Ä—Ç—ã</h3>
                        <div id="shinyCards" class="collection"></div>
                    </div>
                    <div class="mutation-section normal-cards">
                        <h3>–û–±—ã—á–Ω—ã–µ –∫–∞—Ä—Ç—ã</h3>
                        <div id="normalCards" class="collection"></div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="right-column">
            <div class="trade-container">
                <div class="trade-header">–û–±–º–µ–Ω –∫–∞—Ä—Ç–∞–º–∏</div>
                <div id="tradeOffers" class="trade-offers"></div>
                <div class="trade-create">
                    <select id="giveCardSelect" class="trade-select">
                        <option value="">-- –û—Ç–¥–∞—é --</option>
                    </select>
                    <select id="getCardSelect" class="trade-select">
                        <option value="">-- –ü–æ–ª—É—á–∞—é --</option>
                    </select>
                    <button id="createTrade" class="trade-button">–°–æ–∑–¥–∞—Ç—å –æ–±–º–µ–Ω</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ –∫–∞—Ä—Ç–æ—á–µ–∫ –æ—Ç H (—Å–∞–º–æ–π —á–∞—Å—Ç–æ–π) –¥–æ SSS (—Å–∞–º–æ–π —Ä–µ–¥–∫–æ–π)
        const cardTypes = [
            { name: "H", rarity: "–ë–∞–∑–æ–≤—ã–π", color: "#AAAAAA", weight: 16384 },
            { name: "F", rarity: "–û–±—ã—á–Ω—ã–π", color: "#777777", weight: 4096 },
            { name: "E", rarity: "–ù–µ–æ–±—ã—á–Ω—ã–π", color: "#5555FF", weight: 1024 },
            { name: "D", rarity: "–†–µ–¥–∫–∏–π", color: "#AA00AA", weight: 256 },
            { name: "C", rarity: "–≠–ø–∏—á–µ—Å–∫–∏–π", color: "#FFAA00", weight: 64 },
            { name: "B", rarity: "–õ–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–π", color: "#FF5555", weight: 16 },
            { name: "A", rarity: "–ú–∏—Ñ–∏—á–µ—Å–∫–∏–π", color: "#FF0000", weight: 4 },
            { name: "A+", rarity: "–ë–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–π", color: "#FF00FF", weight: 1 },
            { name: "S+", rarity: "–¢—Ä–∞–Ω—Å—Ü–µ–Ω–¥–µ–Ω—Ç–Ω—ã–π", color: "#00FFFF", weight: 0.25 },
            { name: "S++", rarity: "–í–µ—á–Ω—ã–π", color: "#FFFF00", weight: 0.0625 },
            { name: "S+++", rarity: "–ê–±—Å–æ–ª—é—Ç–Ω—ã–π", color: "#00FF00", weight: 0.015625 },
            { name: "S", rarity: "–ü—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω—ã–π", color: "#FF8800", weight: 0.00390625 },
            { name: "SS+", rarity: "–°–≤–µ—Ä—Ö—ä–µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–π", color: "#8800FF", weight: 0.0009765625 },
            { name: "SSS", rarity: "–í—Å–µ–ª–µ–Ω—Å–∫–∏–π", color: "#FF0088", weight: 0.000244140625 }
        ];

        // –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –æ–±—â–∏–π –≤–µ—Å –¥–ª—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π
        const totalWeight = cardTypes.reduce((sum, card) => sum + card.weight, 0);
        
        // –û–±–Ω–æ–≤–ª—è–µ–º —à–∞–Ω—Å—ã –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –≤–µ—Å–æ–º
        cardTypes.forEach(card => {
            const chance = totalWeight / card.weight;
            card.chance = `1 –∫ ${Math.round(chance)}`;
        });

        // –≠–ª–µ–º–µ–Ω—Ç—ã DOM
        const buyPackBtn = document.getElementById('buyPack');
        const buyBigPackBtn = document.getElementById('buyBigPack');
        const buyMegaPackBtn = document.getElementById('buyMegaPack');
        const resetBtn = document.getElementById('resetCollection');
        const cardModal = document.getElementById('cardModal');
        const bigPackModal = document.getElementById('bigPackModal');
        const megaPackModal = document.getElementById('megaPackModal');
        const newCard = document.getElementById('newCard');
        const multiCardContainer = document.getElementById('multiCardContainer');
        const megaCardContainer = document.getElementById('megaCardContainer');
        const cooldownElement = document.getElementById('cooldown');
        const megaPackTimerElement = document.getElementById('megaPackTimer');
        const nextMegaPackTimeElement = document.getElementById('nextMegaPackTime');
        const rarityChancesElement = document.getElementById('rarityChances');
        const accountValueElement = document.getElementById('accountValue');
        const accountRankElement = document.getElementById('accountRank');
        const onlinePlayersElement = document.getElementById('onlinePlayers');
        const totalPlayersElement = document.getElementById('totalPlayers');
        const sidebarCardList = document.getElementById('sidebarCardList');
        const chatMessages = document.getElementById('chatMessages');
        const tradeOffers = document.getElementById('tradeOffers');
        const giveCardSelect = document.getElementById('giveCardSelect');
        const getCardSelect = document.getElementById('getCardSelect');
        const createTradeBtn = document.getElementById('createTrade');
        const loginModal = document.getElementById('loginModal');
        const playerNameInput = document.getElementById('playerNameInput');
        const loginButton = document.getElementById('loginButton');
        const notificationElement = document.getElementById('notification');

        // –≠–ª–µ–º–µ–Ω—Ç—ã –∫–æ–ª–ª–µ–∫—Ü–∏–∏
        const ultraLegendaryCardsSection = document.getElementById('ultraLegendaryCards');
        const goldenCardsSection = document.getElementById('goldenCards');
        const shinyCardsSection = document.getElementById('shinyCards');
        const normalCardsSection = document.getElementById('normalCards');

        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
        let userCollection = loadCollection();
        let isCooldown = false;
        const COOLDOWN_TIME = 3000;
        const BIG_PACK_COOLDOWN = 5000;
        const MEGA_PACK_COOLDOWN = 25 * 60 * 60 * 1000; // 25 —á–∞—Å–æ–≤ –≤ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥–∞—Ö
        let playerName = localStorage.getItem('playerName') || '';
        let socket = null;
        let trades = [];
        let onlinePlayers = 0;
        let megaPackAvailable = false;
        let megaPackTimer = null;

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ç–∞–π–º–µ—Ä–∞ –º–µ–≥–∞ –ø–∞–∫–∞
        function initMegaPackTimer() {
            const lastMegaPackTime = localStorage.getItem('lastMegaPackTime');
            const currentTime = Date.now();
            
            if (!lastMegaPackTime || (currentTime - parseInt(lastMegaPackTime)) >= MEGA_PACK_COOLDOWN) {
                megaPackAvailable = true;
                buyMegaPackBtn.disabled = false;
                megaPackTimerElement.style.display = 'none';
            } else {
                megaPackAvailable = false;
                buyMegaPackBtn.disabled = true;
                megaPackTimerElement.style.display = 'block';
                
                const remainingTime = MEGA_PACK_COOLDOWN - (currentTime - parseInt(lastMegaPackTime));
                updateMegaPackTimer(remainingTime);
                
                megaPackTimer = setInterval(() => {
                    const newRemainingTime = MEGA_PACK_COOLDOWN - (Date.now() - parseInt(lastMegaPackTime));
                    if (newRemainingTime <= 0) {
                        clearInterval(megaPackTimer);
                        megaPackAvailable = true;
                        buyMegaPackBtn.disabled = false;
                        megaPackTimerElement.style.display = 'none';
                        showNotification('–ú–µ–≥–∞ –ø–∞–∫ —Ç–µ–ø–µ—Ä—å –¥–æ—Å—Ç—É–ø–µ–Ω!');
                    } else {
                        updateMegaPackTimer(newRemainingTime);
                    }
                }, 1000);
            }
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–∞–π–º–µ—Ä–∞ –º–µ–≥–∞ –ø–∞–∫–∞
        function updateMegaPackTimer(ms) {
            const hours = Math.floor(ms / (1000 * 60 * 60));
            const minutes = Math.floor((ms % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((ms % (1000 * 60)) / 1000);
            
            const timeString = `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            megaPackTimerElement.textContent = `–ú–µ–≥–∞ –ø–∞–∫ —á–µ—Ä–µ–∑: ${timeString}`;
            nextMegaPackTimeElement.textContent = timeString;
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π –∏ –±—É—Å—Ç–æ–≤
        function checkSpecialEvents() {
            const now = new Date();
            const dayOfWeek = now.getDay(); // 0 (–≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ) - 6 (—Å—É–±–±–æ—Ç–∞)
            const hours = now.getHours();
            const minutes = now.getMinutes();

            // –°—É–±–±–æ—Ç–∞ (–¥–µ–Ω—å 6) –∏ –±—É—Å—Ç √ó1.5
            const isSaturdayBoost = dayOfWeek === 6;
            // –ù–æ—á–Ω–æ–π –±—É—Å—Ç √ó1.3 (—Å 21:01 –¥–æ 7:01)
            const isNightBoost = (hours >= 21 && minutes >= 1) || (hours < 7) || (hours === 7 && minutes < 1);
            // –ü–µ—Ä–≤—ã–π –¥–µ–Ω—å –º–µ—Å—è—Ü–∞ √ó2.0
            const isFirstDayOfMonth = now.getDate() === 1;
            // –ß–∞—Å–æ–≤–∞—è –æ—Ç–º–µ—Ç–∫–∞ (–∫–∞–∂–¥—ã–π —á–∞—Å —Å 0 –ø–æ 59 –º–∏–Ω—É—Ç—É) √ó1.1
            const isHourMark = minutes <= 5;

            let boostMessage = "";
            let boostIcon = "";
            let totalBoost = 1.0;

            if (isFirstDayOfMonth) {
                boostMessage = "üéâ –ú–µ–≥–∞ –±—É—Å—Ç! –ü–µ—Ä–≤—ã–π –¥–µ–Ω—å –º–µ—Å—è—Ü–∞! –®–∞–Ω—Å —Ä–µ–¥–∫–∏—Ö –∫–∞—Ä—Ç √ó2.0!";
                boostIcon = "üéâ";
                totalBoost *= 2.0;
            } else if (isSaturdayBoost && isNightBoost) {
                boostMessage = "üî• –î–≤–æ–π–Ω–æ–π –±—É—Å—Ç! –°–µ–≥–æ–¥–Ω—è —Å—É–±–±–æ—Ç–∞ (+1.5√ó) –∏ –Ω–æ—á–Ω–æ–µ –≤—Ä–µ–º—è (+1.3√ó). –®–∞–Ω—Å —Ä–µ–¥–∫–∏—Ö –∫–∞—Ä—Ç —É–≤–µ–ª–∏—á–µ–Ω!";
                boostIcon = "üî•";
                totalBoost *= 1.5 * 1.3;
            } else if (isSaturdayBoost) {
                boostMessage = "üìÖ –°—É–±–±–æ—Ç–Ω–∏–π –±—É—Å—Ç! –®–∞–Ω—Å —Ä–µ–¥–∫–∏—Ö –∫–∞—Ä—Ç √ó1.5 —Å–µ–≥–æ–¥–Ω—è!";
                boostIcon = "üìÖ";
                totalBoost *= 1.5;
            } else if (isNightBoost) {
                boostMessage = "üåô –ù–æ—á–Ω–æ–π –±—É—Å—Ç! –®–∞–Ω—Å —Ä–µ–¥–∫–∏—Ö –∫–∞—Ä—Ç √ó1.3 (—Å 21:01 –¥–æ 7:01)!";
                boostIcon = "üåô";
                totalBoost *= 1.3;
            } else if (isHourMark) {
                boostMessage = "‚è± –ß–∞—Å–æ–≤–æ–π –±—É—Å—Ç! –ü–µ—Ä–≤—ã–µ 5 –º–∏–Ω—É—Ç –∫–∞–∂–¥–æ–≥–æ —á–∞—Å–∞ —à–∞–Ω—Å √ó1.1!";
                boostIcon = "‚è±";
                totalBoost *= 1.1;
            }

            // –í—ã–≤–æ–¥–∏–º —Å–æ–æ–±—â–µ–Ω–∏–µ (–µ—Å–ª–∏ –µ—Å—Ç—å –±—É—Å—Ç)
            if (boostMessage) {
                showBoostNotification(boostMessage, boostIcon);
            }

            // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –º–Ω–æ–∂–∏—Ç–µ–ª—å –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ –ª–æ–≥–∏–∫–µ –≤—ã–ø–∞–¥–µ–Ω–∏—è –∫–∞—Ä—Ç
            return {
                total: totalBoost,
                details: {
                    saturday: isSaturdayBoost ? 1.5 : 1.0,
                    night: isNightBoost ? 1.3 : 1.0,
                    firstDay: isFirstDayOfMonth ? 2.0 : 1.0,
                    hourMark: isHourMark ? 1.1 : 1.0
                }
            };
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–∫–∞–∑–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –±—É—Å—Ç–µ
        function showBoostNotification(message, icon) {
            const existingNotification = document.querySelector('.boost-notification');
            if (existingNotification) {
                existingNotification.remove();
            }

            const notification = document.createElement('div');
            notification.className = 'boost-notification';
            notification.innerHTML = `
                <span class="icon">${icon}</span>
                <span>${message}</span>
            `;
            
            document.body.appendChild(notification);
            
            // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–∫—Ä—ã—Ç–∏–µ —á–µ—Ä–µ–∑ 10 —Å–µ–∫—É–Ω–¥
            setTimeout(() => {
                notification.style.opacity = '0';
                setTimeout(() => notification.remove(), 500);
            }, 10000);
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ä–∞–Ω–≥–∞ –∫–æ–ª–ª–µ–∫—Ü–∏–æ–Ω–µ—Ä–∞
        function getAccountRank(value) {
            if (value >= 30000) return { name: "–ù–∞–∫—Ä–µ–¥–∏—Ç–∞—Ü–∏–∏ –∫–æ–ª–ª–µ–∫—Ü–∏–æ–Ω–µ—Ä", class: "rank-legendary" };
            if (value >= 20000) return { name: "–∫–æ–ª–ª–µ–∫—Ü–∏–æ–Ω–µ—Ä —Ä–∞–Ω–≥–∞ SSS", class: "rank-sss" };
            if (value >= 10000) return { name: "–∫–æ–ª–ª–µ–∫—Ü–∏–æ–Ω–µ—Ä —Ä–∞–Ω–≥–∞ SS", class: "rank-ss" };
            if (value >= 5000) return { name: "–∫–æ–ª–ª–µ–∫—Ü–∏–æ–Ω–µ—Ä —Ä–∞–Ω–≥–∞ S", class: "rank-s" };
            if (value >= 3000) return { name: "–∫–æ–ª–ª–µ–∫—Ü–∏–æ–Ω–µ—Ä —Ä–∞–Ω–≥–∞ A", class: "rank-a" };
            if (value >= 1000) return { name: "–º–∞—Å—Ç–µ—Ä –∫–æ–ª–ª–µ–∫—Ü–∏–æ–Ω–µ—Ä", class: "rank-master" };
            if (value >= 701) return { name: "–ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –∫–æ–ª–ª–µ–∫—Ü–∏–æ–Ω–µ—Ä", class: "rank-professional" };
            if (value >= 301) return { name: "–æ–ø—ã—Ç–Ω—ã–π –∫–æ–ª–ª–µ–∫—Ü–∏–æ–Ω–µ—Ä", class: "rank-experienced" };
            return { name: "–Ω–∞—á–∏–Ω–∞—é—â–∏–π –∫–æ–ª–ª–µ–∫—Ü–∏–æ–Ω–µ—Ä", class: "rank-beginner" };
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è WebSocket
        function initWebSocket() {
            // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∞–¥—Ä–µ—Å –≤–∞—à–µ–≥–æ WebSocket —Å–µ—Ä–≤–µ—Ä–∞
            const wsUrl = 'wss://your-websocket-server.com/ws';
            
            // –î–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–µ–º —ç–º—É–ª—è—Ü–∏—é WebSocket
            socket = {
                send: (data) => {
                    console.log('WebSocket send:', data);
                    // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –±—É–¥–µ—Ç –æ—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ —Å–µ—Ä–≤–µ—Ä
                    // socket.send(data);
                    
                    // –≠–º—É–ª—è—Ü–∏—è –æ—Ç–≤–µ—Ç–∞ –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞
                    setTimeout(() => {
                        const message = JSON.parse(data);
                        
                        if (message.type === 'create_trade') {
                            // –≠–º—É–ª–∏—Ä—É–µ–º —Å–æ–∑–¥–∞–Ω–∏–µ —Ç—Ä–µ–π–¥–∞
                            const newTrade = {
                                id: Date.now(),
                                player: playerName,
                                giveCard: message.giveCard,
                                getCard: message.getCard
                            };
                            
                            trades.push(newTrade);
                            updateTrades();
                            
                            // –≠–º—É–ª–∏—Ä—É–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –¥—Ä—É–≥–∏–º –∏–≥—Ä–æ–∫–∞–º
                            const tradeMessage = {
                                type: 'new_trade',
                                trade: newTrade
                            };
                            handleWebSocketMessage({ data: JSON.stringify(tradeMessage) });
                        } else if (message.type === 'accept_trade') {
                            // –≠–º—É–ª–∏—Ä—É–µ–º –ø—Ä–∏–Ω—è—Ç–∏–µ —Ç—Ä–µ–π–¥–∞
                            const tradeIndex = trades.findIndex(t => t.id === message.tradeId);
                            if (tradeIndex !== -1) {
                                const trade = trades[tradeIndex];
                                
                                // –£–¥–∞–ª—è–µ–º —Ç—Ä–µ–π–¥ –∏–∑ —Å–ø–∏—Å–∫–∞
                                trades.splice(tradeIndex, 1);
                                updateTrades();
                                
                                // –≠–º—É–ª–∏—Ä—É–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –¥—Ä—É–≥–∏–º –∏–≥—Ä–æ–∫–∞–º
                                const tradeMessage = {
                                    type: 'trade_accepted',
                                    tradeId: message.tradeId,
                                    acceptor: playerName
                                };
                                handleWebSocketMessage({ data: JSON.stringify(tradeMessage) });
                            }
                        }
                    }, 500);
                },
                close: () => console.log('WebSocket closed')
            };
            
            // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –±—É–¥—É—Ç –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π WebSocket
            // socket.onopen = () => {
            //     console.log('WebSocket connected');
            //     sendPlayerInfo();
            //     updateTrades();
            // };
            // 
            // socket.onmessage = handleWebSocketMessage;
            // 
            // socket.onclose = () => {
            //     console.log('WebSocket disconnected');
            //     setTimeout(initWebSocket, 5000);
            // };
            
            // –î–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ —Å—Ä–∞–∑—É "–ø–æ–¥–∫–ª—é—á–∞–µ–º—Å—è"
            setTimeout(() => {
                sendPlayerInfo();
                updateTrades();
            }, 500);
        }

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–æ–æ–±—â–µ–Ω–∏–π WebSocket
        function handleWebSocketMessage(event) {
            const message = JSON.parse(event.data);
            
            switch (message.type) {
                case 'player_count':
                    onlinePlayers = message.count;
                    onlinePlayersElement.textContent = onlinePlayers;
                    break;
                    
                case 'new_trade':
                    // –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–π —Ç—Ä–µ–π–¥ –≤ —Å–ø–∏—Å–æ–∫
                    if (message.trade.player !== playerName) { // –ò–≥—Ä–æ–∫ –Ω–µ –º–æ–∂–µ—Ç –≤–∏–¥–µ—Ç—å —Å–≤–æ–∏ —Ç—Ä–µ–π–¥—ã –≤ –æ–±—â–µ–º —Å–ø–∏—Å–∫–µ
                        trades.push(message.trade);
                        updateTrades();
                        showNotification(`–ù–æ–≤—ã–π —Ç—Ä–µ–π–¥: ${message.trade.player} –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç ${formatCardText(message.trade.getCard)} –∑–∞ ${formatCardText(message.trade.giveCard)}`);
                    }
                    break;
                    
                case 'trade_accepted':
                    // –£–¥–∞–ª—è–µ–º –ø—Ä–∏–Ω—è—Ç—ã–π —Ç—Ä–µ–π–¥ –∏–∑ —Å–ø–∏—Å–∫–∞
                    trades = trades.filter(t => t.id !== message.tradeId);
                    updateTrades();
                    
                    if (message.acceptor === playerName) {
                        showNotification('–í—ã –ø—Ä–∏–Ω—è–ª–∏ —Ç—Ä–µ–π–¥!');
                    } else {
                        showNotification(`–¢—Ä–µ–π–¥ –ø—Ä–∏–Ω—è–ª –∏–≥—Ä–æ–∫ ${message.acceptor}`);
                    }
                    break;
                    
                case 'chat_message':
                    // –î–æ–±–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ —á–∞—Ç
                    addChatMessage(`${message.player}: ${message.text}`, null, message.mutation);
                    break;
                    
                default:
                    console.log('Unknown message type:', message.type);
            }
        }

        // –û—Ç–ø—Ä–∞–≤–∫–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ–± –∏–≥—Ä–æ–∫–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä
        function sendPlayerInfo() {
            if (!socket || !playerName) return;
            
            const message = {
                type: 'player_info',
                name: playerName,
                collection: userCollection
            };
            
            socket.send(JSON.stringify(message));
        }

        // –ü–æ–∫–∞–∑ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
        function showNotification(text) {
            notificationElement.textContent = text;
            notificationElement.style.display = 'block';
            
            setTimeout(() => {
                notificationElement.style.display = 'none';
            }, 3000);
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏—è –≤ —á–∞—Ç
        function addChatMessage(text, cardColor, mutation) {
            const messageElement = document.createElement('div');
            messageElement.className = 'message';
            messageElement.textContent = text;
            
            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ü–≤–µ—Ç –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–∞ –∫–∞—Ä—Ç—ã/–º—É—Ç–∞—Ü–∏–∏
            if (mutation === "golden") {
                messageElement.classList.add('golden-message');
            } else if (mutation === "void") {
                messageElement.style.color = "#000";
                messageElement.style.textShadow = "0 0 3px #fff";
            } else if (cardColor) {
                messageElement.style.color = cardColor;
            }
            
            chatMessages.insertBefore(messageElement, chatMessages.firstChild);
            
            // –ê–≤—Ç–æ–ø—Ä–æ–∫—Ä—É—Ç–∫–∞ –∫ –Ω–æ–≤–æ–º—É —Å–æ–æ–±—â–µ–Ω–∏—é
            chatMessages.scrollTop = 0;
            
            // –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–æ–±—â–µ–Ω–∏–π –≤ —á–∞—Ç–µ
            while (chatMessages.children.length > 100) {
                chatMessages.removeChild(chatMessages.lastChild);
            }
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–ª—É—á–∞–π–Ω–æ–π –∫–∞—Ä—Ç—ã —Å —É—á–µ—Ç–æ–º –±—É—Å—Ç–æ–≤
        function getRandomCard() {
            const boosts = checkSpecialEvents();
            const boostMultiplier = boosts.total;

            // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º –≤–µ—Å —Ä–µ–¥–∫–∏—Ö –∫–∞—Ä—Ç –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –±—É—Å—Ç–æ–º
            const boostedCardTypes = cardTypes.map(card => {
                // –ß–µ–º —Ä–µ–∂–µ –∫–∞—Ä—Ç–∞, —Ç–µ–º —Å–∏–ª—å–Ω–µ–µ –Ω–∞ –Ω–µ–µ –≤–ª–∏—è–µ—Ç –±—É—Å—Ç
                const rarityFactor = 1 + (Math.log(card.weight) / Math.log(2)) / 10;
                const boostedWeight = card.weight * (1 + (boostMultiplier - 1) * rarityFactor);
                return {
                    ...card,
                    weight: boostedWeight
                };
            });

            // –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –æ–±—â–∏–π –≤–µ—Å —Å —É—á–µ—Ç–æ–º –±—É—Å—Ç–∞
            const boostedTotalWeight = boostedCardTypes.reduce((sum, card) => sum + card.weight, 0);
            
            const randomValue = Math.random() * boostedTotalWeight;
            let cumulativeWeight = 0;
            let selectedCard = null;
            
            for (const card of boostedCardTypes) {
                cumulativeWeight += card.weight;
                if (randomValue <= cumulativeWeight) {
                    selectedCard = card;
                    break;
                }
            }
            
            // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –º—É—Ç–∞—Ü–∏—é –∫–∞—Ä—Ç—ã (—Ç–∞–∫–∂–µ —Å –Ω–µ–±–æ–ª—å—à–∏–º –±—É—Å—Ç–æ–º)
            let mutation = null;
            const mutationRoll = Math.random() * 100 * (1 + (boostMultiplier - 1) * 0.5);
            
            if (mutationRoll < 0.0125) { // 0.0125% —à–∞–Ω—Å
                mutation = "void";
            } else if (mutationRoll < 0.1) { // 0.1% —à–∞–Ω—Å (0.1 - 0.0125)
                mutation = "ultra-legendary";
            } else if (mutationRoll < 1.35) { // 1.25% —à–∞–Ω—Å (1.35 - 0.1)
                mutation = "golden";
            } else if (mutationRoll < 11.35) { // 10% —à–∞–Ω—Å (11.35 - 1.35)
                mutation = "shiny";
            }
            
            return {
                ...selectedCard, 
                id: Date.now() + Math.floor(Math.random() * 1000),
                mutation: mutation,
                boosted: boosts.details
            };
        }
        
        // –ü—Ä–∏–º–µ–Ω—è–µ–º —Å—Ç–∏–ª–∏ –º—É—Ç–∞—Ü–∏–∏ –∫ —ç–ª–µ–º–µ–Ω—Ç—É –∫–∞—Ä—Ç—ã
        function applyMutationStyles(cardElement, mutation) {
            if (!mutation) return;
            
            const backSide = cardElement.querySelector('.card-back, .multi-card-back, .mega-card-back');
            const label = cardElement.querySelector('.mutation-label');
            
            if (mutation === "shiny") {
                backSide.classList.add('shiny');
                if (label) {
                    label.textContent = "–ë–ª–µ—Å—Ç—è—â–∞—è";
                    label.classList.add('shiny-label');
                }
            } else if (mutation === "golden") {
                backSide.classList.add('golden');
                if (label) {
                    label.textContent = "–ó–æ–ª–æ—Ç–∞—è";
                    label.classList.add('golden-label');
                }
            } else if (mutation === "ultra-legendary") {
                backSide.classList.add('ultra-legendary');
                if (label) {
                    label.textContent = "–£–ª—å—Ç—Ä–∞–ª–µ–≥–µ–Ω–¥–∞—Ä–Ω–∞—è";
                    label.classList.add('ultra-legendary-label');
                }
            } else if (mutation === "void") {
                backSide.classList.add('void');
                if (label) {
                    label.textContent = "–ü—É—Å—Ç–æ—Ç–Ω–∞—è";
                    label.classList.add('void-label');
                }
            }
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ —Ü–µ–Ω–Ω–æ—Å—Ç–∏ –∞–∫–∫–∞—É–Ω—Ç–∞
        function calculateAccountValue() {
            const rarityValues = {
                'H': 0.1,
                'F': 1,
                'E': 5,
                'D': 15,
                'C': 50,
                'B': 150,
                'A': 400,
                'A+': 600,
                'S+': 1000,
                'S++': 1500,
                'S+++': 2000,
                'S': 2500,
                'SS+': 3000,
                'SSS': 3333
            };
            
            let totalValue = 0;
            
            userCollection.forEach(card => {
                const cardValue = rarityValues[card.name] || 0;
                let multiplier = 1;
                
                // –£—á–∏—Ç—ã–≤–∞–µ–º –º—É—Ç–∞—Ü–∏–∏
                if (card.mutation === "shiny") multiplier = 1.5;
                else if (card.mutation === "golden") multiplier = 3;
                else if (card.mutation === "ultra-legendary") multiplier = 10;
                else if (card.mutation === "void") multiplier = 50;
                
                totalValue += cardValue * multiplier;
            });
            
            return Math.round(totalValue * 10) / 10; // –û–∫—Ä—É–≥–ª—è–µ–º –¥–æ 1 –∑–Ω–∞–∫–∞ –ø–æ—Å–ª–µ –∑–∞–ø—è—Ç–æ–π
        }
        
        // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ü–µ–Ω–Ω–æ—Å—Ç–∏ –∞–∫–∫–∞—É–Ω—Ç–∞ –∏ —Ä–∞–Ω–≥–∞
        function updateAccountValue() {
            const value = calculateAccountValue();
            accountValueElement.textContent = value;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Ä–∞–Ω–≥
            const rank = getAccountRank(value);
            accountRankElement.textContent = rank.name;
            accountRankElement.className = `account-rank ${rank.class}`;
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—á–µ—Ç—á–∏–∫–æ–≤ –∏–≥—Ä–æ–∫–æ–≤
        function updatePlayerCounters() {
            let playerStats = JSON.parse(localStorage.getItem('playerStats')) || {
                total: 0,
                online: 0,
                lastSession: null
            };
            
            const isNewVisitor = !playerStats.lastSession || 
                         (Date.now() - playerStats.lastSession) > 30 * 60 * 1000; // 30 –º–∏–Ω—É—Ç
            
            if (isNewVisitor) {
                playerStats.total += 1;
            }
            
            playerStats.online = onlinePlayers;
            playerStats.lastSession = Date.now();
            
            localStorage.setItem('playerStats', JSON.stringify(playerStats));
            
            onlinePlayersElement.textContent = playerStats.online;
            totalPlayersElement.textContent = playerStats.total;
        }
        
        // –ö—É–ª–¥–∞—É–Ω –Ω–∞ –æ—Ç–∫—Ä—ã—Ç–∏–µ –∫–∞—Ä—Ç–æ—á–µ–∫
        function startCooldown(time) {
            isCooldown = true;
            buyPackBtn.disabled = true;
            buyBigPackBtn.disabled = true;
            buyMegaPackBtn.disabled = true;
            let timeLeft = time / 1000;
            
            cooldownElement.style.display = 'block';
            cooldownElement.textContent = `–ü–æ–¥–æ–∂–¥–∏—Ç–µ ${timeLeft} —Å–µ–∫`;
            
            const interval = setInterval(() => {
                timeLeft--;
                cooldownElement.textContent = `–ü–æ–¥–æ–∂–¥–∏—Ç–µ ${timeLeft} —Å–µ–∫`;
                
                if (timeLeft <= 0) {
                    clearInterval(interval);
                    isCooldown = false;
                    buyPackBtn.disabled = false;
                    buyBigPackBtn.disabled = false;
                    buyMegaPackBtn.disabled = !megaPackAvailable;
                    cooldownElement.style.display = 'none';
                }
            }, 1000);
        }
        
        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–æ–ª–ª–µ–∫—Ü–∏–∏
        function saveCollection() {
            localStorage.setItem('cardCollection', JSON.stringify(userCollection));
            sendPlayerInfo(); // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–æ–ª–ª–µ–∫—Ü–∏–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
        }
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ–ª–ª–µ–∫—Ü–∏–∏
        function loadCollection() {
            const savedCollection = localStorage.getItem('cardCollection');
            return savedCollection ? JSON.parse(savedCollection) : [];
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Ä–µ–¥–∫–æ—Å—Ç—è—Ö
        function updateRarityInfo() {
            rarityChancesElement.innerHTML = cardTypes.map(card => 
                `<div><strong>${card.name}</strong> (${card.rarity}): ${card.chance}</div>`
            ).join('');
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫–æ–ª–ª–µ–∫—Ü–∏–∏
        function updateCollection() {
            // –û—á–∏—â–∞–µ–º –≤—Å–µ —Ä–∞–∑–¥–µ–ª—ã –∫–æ–ª–ª–µ–∫—Ü–∏–∏
            ultraLegendaryCardsSection.innerHTML = '';
            goldenCardsSection.innerHTML = '';
            shinyCardsSection.innerHTML = '';
            normalCardsSection.innerHTML = '';
            sidebarCardList.innerHTML = '';
            
            // –ì—Ä—É–ø–ø–∏—Ä—É–µ–º –∫–∞—Ä—Ç—ã –ø–æ —Ç–∏–ø—É –∏ –º—É—Ç–∞—Ü–∏–∏
            const groupedCards = {};
            
            userCollection.forEach(card => {
                const key = `${card.name}-${card.mutation || 'normal'}`;
                if (!groupedCards[key]) {
                    groupedCards[key] = {
                        card: card,
                        count: 0
                    };
                }
                groupedCards[key].count++;
            });
            
            // –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –æ–±—ä–µ–∫—Ç –≤ –º–∞—Å—Å–∏–≤ –∏ —Å–æ—Ä—Ç–∏—Ä—É–µ–º
            const sortedGroups = Object.values(groupedCards).sort((a, b) => {
                const aIndex = cardTypes.findIndex(c => c.name === a.card.name);
                const bIndex = cardTypes.findIndex(c => c.name === b.card.name);
                return bIndex - aIndex; // –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –æ—Ç SSS –∫ H
            });
            
            // –î–æ–±–∞–≤–ª—è–µ–º –∫–∞—Ä—Ç—ã –≤ —Å–∞–π–¥–±–∞—Ä
            sortedGroups.forEach(group => {
                const card = group.card;
                const count = group.count;
                
                // –°–æ–∑–¥–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç –¥–ª—è —Å–∞–π–¥–±–∞—Ä–∞
                const listItem = document.createElement('div');
                listItem.className = 'card-list-item';
                
                // –°–æ–∑–¥–∞–µ–º –ø—Ä–µ–≤—å—é –∫–∞—Ä—Ç—ã
                const preview = document.createElement('div');
                preview.className = 'card-preview';
                preview.style.backgroundColor = card.color;
                // –ü—Ä–∏–º–µ–Ω—è–µ–º —Å—Ç–∏–ª–∏ –º—É—Ç–∞—Ü–∏–∏ –¥–ª—è –ø—Ä–µ–≤—å—é
                if (card.mutation === "shiny") {
                    preview.classList.add('shiny-preview');
                } else if (card.mutation === "golden") {
                    preview.classList.add('golden-preview');
                } else if (card.mutation === "ultra-legendary") {
                    preview.classList.add('ultra-legendary-preview');
                } else if (card.mutation === "void") {
                    preview.classList.add('void-preview');
                }
                
                preview.textContent = card.name;
                
                // –°–æ–∑–¥–∞–µ–º –±–ª–æ–∫ —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –∫–∞—Ä—Ç–µ
                const info = document.createElement('div');
                info.className = 'card-info';
                
                const name = document.createElement('div');
                name.className = 'card-name-small';
                name.textContent = card.rarity;
                
                const rarity = document.createElement('div');
                rarity.className = 'card-rarity-small';
                rarity.textContent = card.name;
                
                info.appendChild(name);
                info.appendChild(rarity);
                
                // –°–æ–∑–¥–∞–µ–º —Å—á–µ—Ç—á–∏–∫ –∫–∞—Ä—Ç
                const counter = document.createElement('div');
                counter.className = 'card-count';
                counter.textContent = count;
                
                // –°–æ–±–∏—Ä–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç —Å–ø–∏—Å–∫–∞
                listItem.appendChild(preview);
                listItem.appendChild(info);
                listItem.appendChild(counter);
                
                // –î–æ–±–∞–≤–ª—è–µ–º –≤ —Å–∞–π–¥–±–∞—Ä
                sidebarCardList.appendChild(listItem);
                
                // –î–æ–±–∞–≤–ª—è–µ–º –∫–∞—Ä—Ç—ã –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ —Ä–∞–∑–¥–µ–ª—ã –∫–æ–ª–ª–µ–∫—Ü–∏–∏
                const cardGroup = document.createElement('div');
                cardGroup.className = 'card-group';
                
                const countBadge = document.createElement('div');
                countBadge.className = 'card-count';
                countBadge.textContent = count;
                cardGroup.appendChild(countBadge);
                
                // –°–æ–∑–¥–∞–µ–º 1-3 –∫–∞—Ä—Ç—ã –¥–ª—è –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ —Å—Ç–æ–ø–∫–µ
                const displayCount = Math.min(count, 3);
                for (let i = 0; i < displayCount; i++) {
                    const cardElement = document.createElement('div');
                    cardElement.className = `stacked-card pos-${i}`;
                    cardElement.style.backgroundColor = card.color;
                    cardElement.innerHTML = `
                        <div class="card-name">${card.name}</div>
                        <div class="card-rarity">${card.rarity}</div>
                        <div class="card-chance">${card.chance}</div>
                    `;
                    
                    // –ü—Ä–∏–º–µ–Ω—è–µ–º —Å—Ç–∏–ª–∏ –º—É—Ç–∞—Ü–∏–∏
                    if (card.mutation === "shiny") {
                        cardElement.classList.add('shiny');
                    } else if (card.mutation === "golden") {
                        cardElement.classList.add('golden');
                    } else if (card.mutation === "ultra-legendary") {
                        cardElement.classList.add('ultra-legendary');
                    } else if (card.mutation === "void") {
                        cardElement.classList.add('void');
                    }
                    
                    cardGroup.appendChild(cardElement);
                }
                
                // –î–æ–±–∞–≤–ª—è–µ–º –≥—Ä—É–ø–ø—É –∫–∞—Ä—Ç –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π —Ä–∞–∑–¥–µ–ª –∫–æ–ª–ª–µ–∫—Ü–∏–∏
                if (card.mutation === "ultra-legendary") {
                    ultraLegendaryCardsSection.appendChild(cardGroup);
                } else if (card.mutation === "golden") {
                    goldenCardsSection.appendChild(cardGroup);
                } else if (card.mutation === "shiny") {
                    shinyCardsSection.appendChild(cardGroup);
                } else {
                    normalCardsSection.appendChild(cardGroup);
                }
            });
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å–µ–ª–µ–∫—Ç–æ—Ä—ã –¥–ª—è —Ç—Ä–µ–π–¥–æ–≤
            updateTradeSelects();
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–µ–ª–µ–∫—Ç–æ—Ä–æ–≤ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ç—Ä–µ–π–¥–æ–≤
        function updateTradeSelects() {
            // –û—á–∏—â–∞–µ–º —Å–µ–ª–µ–∫—Ç–æ—Ä—ã
            giveCardSelect.innerHTML = '<option value="">-- –û—Ç–¥–∞—é --</option>';
            getCardSelect.innerHTML = '<option value="">-- –ü–æ–ª—É—á–∞—é --</option>';
            
            // –°–æ–∑–¥–∞–µ–º —É–Ω–∏–∫–∞–ª—å–Ω—ã–π —Å–ø–∏—Å–æ–∫ –∫–∞—Ä—Ç –≤ –∫–æ–ª–ª–µ–∫—Ü–∏–∏
            const uniqueCards = {};
            userCollection.forEach(card => {
                const key = `${card.name}-${card.mutation || 'normal'}`;
                if (!uniqueCards[key]) {
                    uniqueCards[key] = card;
                }
            });
            
            // –î–æ–±–∞–≤–ª—è–µ–º –∫–∞—Ä—Ç—ã –≤ —Å–µ–ª–µ–∫—Ç–æ—Ä "–û—Ç–¥–∞—é" (–∏—Å–∫–ª—é—á–∞—è –ø—É—Å—Ç–æ—Ç–Ω—ã–µ)
            Object.values(uniqueCards).forEach(card => {
                if (card.mutation === "void") return; // –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –ø—É—Å—Ç–æ—Ç–Ω—ã–µ –∫–∞—Ä—Ç—ã
                
                const option = document.createElement('option');
                option.value = `${card.name}-${card.mutation || 'normal'}`;
                
                let displayText = card.name;
                if (card.mutation === "shiny") displayText += " (–ë–ª–µ—Å—Ç—è—â–∞—è)";
                else if (card.mutation === "golden") displayText += " (–ó–æ–ª–æ—Ç–∞—è)";
                else if (card.mutation === "ultra-legendary") displayText += " (–£–ª—å—Ç—Ä–∞–ª–µ–≥–µ–Ω–¥–∞—Ä–Ω–∞—è)";
                else if (card.mutation === "void") displayText += " (–ü—É—Å—Ç–æ—Ç–Ω–∞—è)";
                
                option.textContent = displayText;
                giveCardSelect.appendChild(option);
            });
            
            // –î–æ–±–∞–≤–ª—è–µ–º –≤—Å–µ –≤–æ–∑–º–æ–∂–Ω—ã–µ –∫–∞—Ä—Ç—ã –≤ —Å–µ–ª–µ–∫—Ç–æ—Ä "–ü–æ–ª—É—á–∞—é"
            cardTypes.forEach(card => {
                ['normal', 'shiny', 'golden', 'ultra-legendary'].forEach(mutation => {
                    const option = document.createElement('option');
                    option.value = `${card.name}-${mutation}`;
                    
                    let displayText = card.name;
                    if (mutation === "shiny") displayText += " (–ë–ª–µ—Å—Ç—è—â–∞—è)";
                    else if (mutation === "golden") displayText += " (–ó–æ–ª–æ—Ç–∞—è)";
                    else if (mutation === "ultra-legendary") displayText += " (–£–ª—å—Ç—Ä–∞–ª–µ–≥–µ–Ω–¥–∞—Ä–Ω–∞—è)";
                    else if (mutation === "void") displayText += " (–ü—É—Å—Ç–æ—Ç–Ω–∞—è)";
                    
                    option.textContent = displayText;
                    getCardSelect.appendChild(option);
                });
            });
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ —Ç—Ä–µ–π–¥–æ–≤
        function updateTrades() {
            // –û—á–∏—â–∞–µ–º —Å–ø–∏—Å–æ–∫ —Ç—Ä–µ–π–¥–æ–≤
            tradeOffers.innerHTML = '';
            
            // –î–æ–±–∞–≤–ª—è–µ–º —Ç—Ä–µ–π–¥—ã –≤ —Å–ø–∏—Å–æ–∫ (–∏—Å–∫–ª—é—á–∞—è —Ç—Ä–µ–π–¥—ã —Ç–µ–∫—É—â–µ–≥–æ –∏–≥—Ä–æ–∫–∞)
            trades.filter(trade => trade.player !== playerName).forEach(trade => {
                const tradeElement = document.createElement('div');
                tradeElement.className = 'trade-offer';
                
                const giveText = formatCardText(trade.giveCard);
                const getText = formatCardText(trade.getCard);
                
                tradeElement.innerHTML = `
                    <div><strong>${trade.player}</strong> –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç:</div>
                    <div>${getText} ‚Üê ${giveText}</div>
                `;
                
                tradeElement.addEventListener('click', () => {
                    if (confirm(`–í—ã —Ö–æ—Ç–∏—Ç–µ –æ–±–º–µ–Ω—è—Ç—å ${giveText} –Ω–∞ ${getText}?`)) {
                        acceptTrade(trade);
                    }
                });
                
                tradeOffers.appendChild(tradeElement);
            });
        }
        
        // –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ –∫–∞—Ä—Ç—ã –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
        function formatCardText(card) {
            if (!card) return "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ";
            
            // –ù–∞—Ö–æ–¥–∏–º –ø–æ–ª–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∫–∞—Ä—Ç—ã –ø–æ –∏–º–µ–Ω–∏
            const cardData = cardTypes.find(c => c.name === card.name) || {};
            
            let text = card.name;
            if (card.mutation === "shiny") text += " (–ë–ª–µ—Å—Ç—è—â–∞—è)";
            else if (card.mutation === "golden") text += " (–ó–æ–ª–æ—Ç–∞—è)";
            else if (card.mutation === "ultra-legendary") text += " (–£–ª—å—Ç—Ä–∞–ª–µ–≥–µ–Ω–¥–∞—Ä–Ω–∞—è)";
            else if (card.mutation === "void") text += " (–ü—É—Å—Ç–æ—Ç–Ω–∞—è)";
            
            return text;
        }
        
        // –ü—Ä–∏–Ω—è—Ç–∏–µ —Ç—Ä–µ–π–¥–∞
        function acceptTrade(trade) {
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —É –Ω–∞—Å –∫–∞—Ä—Ç–∞ –¥–ª—è –æ–±–º–µ–Ω–∞
            const hasCard = userCollection.some(card => 
                card.name === trade.giveCard.name && 
                (card.mutation || 'normal') === (trade.giveCard.mutation || 'normal')
            );
            
            if (!hasCard) {
                showNotification('–£ –≤–∞—Å –Ω–µ—Ç –Ω—É–∂–Ω–æ–π –∫–∞—Ä—Ç—ã –¥–ª—è —ç—Ç–æ–≥–æ –æ–±–º–µ–Ω–∞!');
                return;
            }
            
            // –£–¥–∞–ª—è–µ–º –∫–∞—Ä—Ç—É –∏–∑ –∫–æ–ª–ª–µ–∫—Ü–∏–∏
            const cardIndex = userCollection.findIndex(card => 
                card.name === trade.giveCard.name && 
                (card.mutation || 'normal') === (trade.giveCard.mutation || 'normal')
            );
            
            if (cardIndex !== -1) {
                userCollection.splice(cardIndex, 1);
            }
            
            // –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—É—é –∫–∞—Ä—Ç—É —Å –ø–æ–ª–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
            const cardType = cardTypes.find(c => c.name === trade.getCard.name) || {};
            const newCard = {
                ...cardType,
                id: Date.now() + Math.floor(Math.random() * 1000),
                name: trade.getCard.name,
                mutation: trade.getCard.mutation === 'normal' ? null : trade.getCard.mutation
            };
            
            userCollection.push(newCard);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∫–æ–ª–ª–µ–∫—Ü–∏—é
            saveCollection();
            updateCollection();
            updateAccountValue();
            
            // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä –æ –ø—Ä–∏–Ω—è—Ç–∏–∏ —Ç—Ä–µ–π–¥–∞
            if (socket) {
                const message = {
                    type: 'accept_trade',
                    tradeId: trade.id
                };
                socket.send(JSON.stringify(message));
            }
            
            showNotification(`–í—ã —É—Å–ø–µ—à–Ω–æ –æ–±–º–µ–Ω—è–ª–∏ ${formatCardText(trade.giveCard)} –Ω–∞ ${formatCardText(trade.getCard)}!`);
        }
        
        // –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Ç—Ä–µ–π–¥–∞
        createTradeBtn.addEventListener('click', function() {
            const giveValue = giveCardSelect.value;
            const getValue = getCardSelect.value;
            
            if (!giveValue || !getValue) {
                showNotification('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ä—Ç—ã –¥–ª—è –æ–±–º–µ–Ω–∞!');
                return;
            }
            
            const [giveName, giveMutation] = giveValue.split('-');
            const [getName, getMutation] = getValue.split('-');
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —É –Ω–∞—Å –∫–∞—Ä—Ç–∞ –¥–ª—è –æ–±–º–µ–Ω–∞
            const hasCard = userCollection.some(card => 
                card.name === giveName && 
                (card.mutation || 'normal') === giveMutation
            );
            
            if (!hasCard) {
                showNotification('–£ –≤–∞—Å –Ω–µ—Ç –≤—ã–±—Ä–∞–Ω–Ω–æ–π –∫–∞—Ä—Ç—ã –¥–ª—è –æ–±–º–µ–Ω–∞!');
                return;
            }
            
            // –°–æ–∑–¥–∞–µ–º –æ–±—ä–µ–∫—Ç –∫–∞—Ä—Ç—ã –¥–ª—è –æ–±–º–µ–Ω–∞
            const giveCard = {
                name: giveName,
                mutation: giveMutation === 'normal' ? null : giveMutation
            };
            
            const getCard = {
                name: getName,
                mutation: getMutation === 'normal' ? null : getMutation
            };
            
            // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Ç—Ä–µ–π–¥ –Ω–∞ —Å–µ—Ä–≤–µ—Ä
            if (socket) {
                const message = {
                    type: 'create_trade',
                    giveCard: giveCard,
                    getCard: getCard
                };
                socket.send(JSON.stringify(message));
            }
            
            showNotification(`–í—ã —Å–æ–∑–¥–∞–ª–∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –æ–±–º–µ–Ω–∞: ${formatCardText(giveCard)} –Ω–∞ ${formatCardText(getCard)}`);
            
            // –û—á–∏—â–∞–µ–º –≤—ã–±–æ—Ä
            giveCardSelect.value = '';
            getCardSelect.value = '';
        });
        
        // –ü–æ–∫—É–ø–∫–∞ –æ–±—ã—á–Ω–æ–≥–æ –ø–∞–∫–∞ (1 –∫–∞—Ä—Ç–∞)
        buyPackBtn.addEventListener('click', function() {
            if (isCooldown) return;
            
            // –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –∫—É–ª–¥–∞—É–Ω
            startCooldown(COOLDOWN_TIME);
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å –∫–∞—Ä—Ç–æ—á–∫–æ–π —Ä—É–±–∞—à–∫–æ–π –≤–≤–µ—Ä—Ö
            newCard.classList.remove('flipped');
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–µ –º—É—Ç–∞—Ü–∏–∏
            newCard.querySelector('.card-back').className = 'card-back';
            newCard.querySelector('.mutation-label').textContent = '';
            newCard.querySelector('.mutation-label').className = 'mutation-label';
            cardModal.style.display = 'flex';
            
            // –ß–µ—Ä–µ–∑ –Ω–µ–±–æ–ª—å—à—É—é –∑–∞–¥–µ—Ä–∂–∫—É –≤—ã–±–∏—Ä–∞–µ–º –∫–∞—Ä—Ç–æ—á–∫—É
            setTimeout(() => {
                const card = getRandomCard();
                
                // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∫–∞—Ä—Ç–æ—á–∫–∏
                const cardBack = newCard.querySelector('.card-back');
                cardBack.style.backgroundColor = card.color;
                cardBack.querySelector('.card-name').textContent = card.name;
                cardBack.querySelector('.card-rarity').textContent = card.rarity;
                cardBack.querySelector('.card-chance').textContent = card.chance;
                
                // –ü—Ä–∏–º–µ–Ω—è–µ–º –º—É—Ç–∞—Ü–∏—é
                applyMutationStyles(newCard, card.mutation);
                
                // –ê–Ω–∏–º–∏—Ä—É–µ–º –ø–µ—Ä–µ–≤–æ—Ä–æ—Ç –∫–∞—Ä—Ç–æ—á–∫–∏
                setTimeout(() => {
                    newCard.classList.add('flipped');
                    
                    // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–∫—Ä—É—Ç–∫–∞ –∫ –Ω–æ–≤–æ–π –∫–∞—Ä—Ç–µ –≤ –∫–æ–ª–ª–µ–∫—Ü–∏–∏
                    setTimeout(() => {
                        userCollection.push(card);
                        saveCollection();
                        updateAccountValue();
                        updateCollection();
                        
                        // –î–æ–±–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ —á–∞—Ç —Ç–æ–ª—å–∫–æ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö –∫–∞—Ä—Ç/–º—É—Ç–∞—Ü–∏–π
                        const isCommonCard = ['H', 'F'].includes(card.name);
                        const isNormalMutation = !card.mutation || card.mutation === "shiny";
                        
                        if (!(isCommonCard && isNormalMutation)) {
                            let message = `–ü–æ–ª—É—á–µ–Ω–∞ –∫–∞—Ä—Ç–∞ ${card.name}`;
                            if (card.mutation === "shiny") {
                                message = `–ü–æ–ª—É—á–µ–Ω–∞ –±–ª–µ—Å—Ç—è—â–∞—è –∫–∞—Ä—Ç–∞ ${card.name}!`;
                            } else if (card.mutation === "golden") {
                                message = `–ü–æ–ª—É—á–µ–Ω–∞ –∑–æ–ª–æ—Ç–∞—è –∫–∞—Ä—Ç–∞ ${card.name}!!`;
                            } else if (card.mutation === "ultra-legendary") {
                                message = `–ü–æ–ª—É—á–µ–Ω–∞ –£–õ–¨–¢–†–ê–õ–ï–ì–ï–ù–î–ê–†–ù–ê–Ø –∫–∞—Ä—Ç–∞ ${card.name}!!!`;
                            } else if (card.mutation === "void") {
                                message = `–ü–æ–ª—É—á–µ–Ω–∞ –ü–£–°–¢–û–¢–ù–ê–Ø –∫–∞—Ä—Ç–∞ ${card.name}!!!!`;
                            }
                            
                            addChatMessage(message, card.color, card.mutation);
                            
                            // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ –≥–ª–æ–±–∞–ª—å–Ω—ã–π —á–∞—Ç
                            if (socket) {
                                const chatMessage = {
                                    type: 'chat_message',
                                    text: message,
                                    mutation: card.mutation
                                };
                                socket.send(JSON.stringify(chatMessage));
                            }
                        }
                        
                        // –ü—Ä–æ–∫—Ä—É—á–∏–≤–∞–µ–º –∫ –ø–æ—Å–ª–µ–¥–Ω–µ–π –¥–æ–±–∞–≤–ª–µ–Ω–Ω–æ–π –∫–∞—Ä—Ç–µ
                        const lastCard = document.querySelector('.card-group:last-child');
                        if (lastCard) {
                            lastCard.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
                        }
                    }, 1000);
                }, 500);
            }, 500);
        });
        
        // –ü–æ–∫—É–ø–∫–∞ –±–æ–ª—å—à–æ–≥–æ –ø–∞–∫–∞ (5-7 –∫–∞—Ä—Ç)
        buyBigPackBtn.addEventListener('click', function() {
            if (isCooldown) return;
            
            // –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –∫—É–ª–¥–∞—É–Ω
            startCooldown(BIG_PACK_COOLDOWN);
            
            // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–∞—Ä—Ç –≤ –ø–∞–∫–µ (5-7)
            const cardCount = 5 + Math.floor(Math.random() * 3);
            
            // –û—á–∏—â–∞–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –∫–∞—Ä—Ç
            multiCardContainer.innerHTML = '';
            
            // –°–æ–∑–¥–∞–µ–º –∫–∞—Ä—Ç—ã –¥–ª—è –ø–∞–∫–∞
            const cards = [];
            for (let i = 0; i < cardCount; i++) {
                cards.push(getRandomCard());
            }
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å –ø–∞–∫–æ–º –∫–∞—Ä—Ç
            bigPackModal.style.display = 'flex';
            
            // –°–æ–∑–¥–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã –∫–∞—Ä—Ç
            cards.forEach((card, index) => {
                const cardElement = document.createElement('div');
                cardElement.className = 'multi-card';
                cardElement.innerHTML = `
                    <div class="multi-card-front">–ö–∞—Ä—Ç–∞ ${index + 1}</div>
                    <div class="multi-card-back" style="background-color: ${card.color}">
                        <div class="card-name">${card.name}</div>
                        <div class="card-rarity">${card.rarity}</div>
                        <div class="card-chance">${card.chance}</div>
                        <div class="mutation-label"></div>
                    </div>
                `;
                multiCardContainer.appendChild(cardElement);
                
                // –ü—Ä–∏–º–µ–Ω—è–µ–º –º—É—Ç–∞—Ü–∏—é
                applyMutationStyles(cardElement, card.mutation);
                
                // –ê–Ω–∏–º–∏—Ä—É–µ–º –ø–µ—Ä–µ–≤–æ—Ä–æ—Ç –∫–∞—Ä—Ç–æ—á–µ–∫ —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π
                setTimeout(() => {
                    cardElement.classList.add('flipped');
                    
                    // –ü—Ä–æ–∫—Ä—É—á–∏–≤–∞–µ–º –∫ –ø–æ—Å–ª–µ–¥–Ω–µ–π –æ—Ç–∫—Ä—ã—Ç–æ–π –∫–∞—Ä—Ç–µ
                    if (index === cards.length - 1) {
                        setTimeout(() => {
                            cardElement.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
                        }, 300);
                    }
                }, 500 + (index * 300));
            });
            
            // –î–æ–±–∞–≤–ª—è–µ–º –≤—Å–µ –∫–∞—Ä—Ç—ã –≤ –∫–æ–ª–ª–µ–∫—Ü–∏—é
            userCollection.push(...cards);
            saveCollection();
            updateAccountValue();
            
            // –î–æ–±–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏—è –≤ —á–∞—Ç –æ –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö –∫–∞—Ä—Ç–∞—Ö (—Ç–æ–ª—å–∫–æ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö –∫–∞—Ä—Ç/–º—É—Ç–∞—Ü–∏–π)
            cards.forEach(card => {
                const isCommonCard = ['H', 'F'].includes(card.name);
                const isNormalMutation = !card.mutation || card.mutation === "shiny";
                
                if (!(isCommonCard && isNormalMutation)) {
                    let message = `–ü–æ–ª—É—á–µ–Ω–∞ –∫–∞—Ä—Ç–∞ ${card.name}`;
                    if (card.mutation === "shiny") {
                        message = `–ü–æ–ª—É—á–µ–Ω–∞ –±–ª–µ—Å—Ç—è—â–∞—è –∫–∞—Ä—Ç–∞ ${card.name}!`;
                    } else if (card.mutation === "golden") {
                        message = `–ü–æ–ª—É—á–µ–Ω–∞ –∑–æ–ª–æ—Ç–∞—è –∫–∞—Ä—Ç–∞ ${card.name}!!`;
                    } else if (card.mutation === "ultra-legendary") {
                        message = `–ü–æ–ª—É—á–µ–Ω–∞ –£–õ–¨–¢–†–ê–õ–ï–ì–ï–ù–î–ê–†–ù–ê–Ø –∫–∞—Ä—Ç–∞ ${card.name}!!!`;
                    } else if (card.mutation === "void") {
                        message = `–ü–æ–ª—É—á–µ–Ω–∞ –ü–£–°–¢–û–¢–ù–ê–Ø –∫–∞—Ä—Ç–∞ ${card.name}!!!!`;
                    }
                    
                    addChatMessage(message, card.color, card.mutation);
                    
                    // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ –≥–ª–æ–±–∞–ª—å–Ω—ã–π —á–∞—Ç
                    if (socket) {
                        const chatMessage = {
                            type: 'chat_message',
                            text: message,
                            mutation: card.mutation
                        };
                        socket.send(JSON.stringify(chatMessage));
                    }
                }
            });
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∫–æ–ª–ª–µ–∫—Ü–∏—é –∏ –ø—Ä–æ–∫—Ä—É—á–∏–≤–∞–µ–º –∫ –Ω–æ–≤—ã–º –∫–∞—Ä—Ç–∞–º
            setTimeout(() => {
                updateCollection();
                
                // –ü—Ä–æ–∫—Ä—É—á–∏–≤–∞–µ–º –∫–æ–ª–ª–µ–∫—Ü–∏—é –∫ –ø–æ—Å–ª–µ–¥–Ω–∏–º –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã–º –∫–∞—Ä—Ç–∞–º
                collection.scrollTo({
                    top: collection.scrollHeight,
                    behavior: 'smooth'
                });
            }, 1000);
        });
        
        // –ü–æ–∫—É–ø–∫–∞ –º–µ–≥–∞ –ø–∞–∫–∞ (100 –∫–∞—Ä—Ç)
        buyMegaPackBtn.addEventListener('click', function() {
            if (isCooldown || !megaPackAvailable) return;
            
            // –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –∫—É–ª–¥–∞—É–Ω
            startCooldown(COOLDOWN_TIME);
            
            // –û—á–∏—â–∞–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –∫–∞—Ä—Ç
            megaCardContainer.innerHTML = '';
            
            // –°–æ–∑–¥–∞–µ–º –∫–∞—Ä—Ç—ã –¥–ª—è –º–µ–≥–∞ –ø–∞–∫–∞
            const cards = [];
            for (let i = 0; i < 100; i++) {
                cards.push(getRandomCard());
            }
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å –º–µ–≥–∞ –ø–∞–∫–æ–º –∫–∞—Ä—Ç
            megaPackModal.style.display = 'flex';
            
            // –°–æ–∑–¥–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã –∫–∞—Ä—Ç
            cards.forEach((card, index) => {
                const cardElement = document.createElement('div');
                cardElement.className = 'mega-card';
                cardElement.innerHTML = `
                    <div class="mega-card-front">–ö–∞—Ä—Ç–∞ ${index + 1}</div>
                    <div class="mega-card-back" style="background-color: ${card.color}">
                        <div class="card-name">${card.name}</div>
                        <div class="card-rarity">${card.rarity}</div>
                        <div class="card-chance">${card.chance}</div>
                        <div class="mutation-label"></div>
                    </div>
                `;
                megaCardContainer.appendChild(cardElement);
                
                // –ü—Ä–∏–º–µ–Ω—è–µ–º –º—É—Ç–∞—Ü–∏—é
                applyMutationStyles(cardElement, card.mutation);
                
                // –ê–Ω–∏–º–∏—Ä—É–µ–º –ø–µ—Ä–µ–≤–æ—Ä–æ—Ç –∫–∞—Ä—Ç–æ—á–µ–∫ —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π
                setTimeout(() => {
                    cardElement.classList.add('flipped');
                    
                    // –ü—Ä–æ–∫—Ä—É—á–∏–≤–∞–µ–º –∫ –ø–æ—Å–ª–µ–¥–Ω–µ–π –æ—Ç–∫—Ä—ã—Ç–æ–π –∫–∞—Ä—Ç–µ
                    if (index === cards.length - 1) {
                        setTimeout(() => {
                            cardElement.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
                        }, 300);
                    }
                }, 500 + (index * 50)); // –ú–µ–Ω—å—à–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –¥–ª—è –º–µ–≥–∞ –ø–∞–∫–∞
            });
            
            // –î–æ–±–∞–≤–ª—è–µ–º –≤—Å–µ –∫–∞—Ä—Ç—ã –≤ –∫–æ–ª–ª–µ–∫—Ü–∏—é
            userCollection.push(...cards);
            saveCollection();
            updateAccountValue();
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤—Ä–µ–º—è –æ—Ç–∫—Ä—ã—Ç–∏—è –º–µ–≥–∞ –ø–∞–∫–∞
            localStorage.setItem('lastMegaPackTime', Date.now());
            megaPackAvailable = false;
            buyMegaPackBtn.disabled = true;
            
            // –ó–∞–ø—É—Å–∫–∞–µ–º —Ç–∞–π–º–µ—Ä –¥–æ —Å–ª–µ–¥—É—é—â–µ–≥–æ –º–µ–≥–∞ –ø–∞–∫–∞
            initMegaPackTimer();
            
            // –î–æ–±–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏—è –≤ —á–∞—Ç –æ —Ä–µ–¥–∫–∏—Ö –∫–∞—Ä—Ç–∞—Ö
            cards.forEach(card => {
                const isCommonCard = ['H', 'F'].includes(card.name);
                const isNormalMutation = !card.mutation || card.mutation === "shiny";
                
                if (!(isCommonCard && isNormalMutation)) {
                    let message = `–ü–æ–ª—É—á–µ–Ω–∞ –∫–∞—Ä—Ç–∞ ${card.name}`;
                    if (card.mutation === "shiny") {
                        message = `–ü–æ–ª—É—á–µ–Ω–∞ –±–ª–µ—Å—Ç—è—â–∞—è –∫–∞—Ä—Ç–∞ ${card.name}!`;
                    } else if (card.mutation === "golden") {
                        message = `–ü–æ–ª—É—á–µ–Ω–∞ –∑–æ–ª–æ—Ç–∞—è –∫–∞—Ä—Ç–∞ ${card.name}!!`;
                    } else if (card.mutation === "ultra-legendary") {
                        message = `–ü–æ–ª—É—á–µ–Ω–∞ –£–õ–¨–¢–†–ê–õ–ï–ì–ï–ù–î–ê–†–ù–ê–Ø –∫–∞—Ä—Ç–∞ ${card.name}!!!`;
                    } else if (card.mutation === "void") {
                        message = `–ü–æ–ª—É—á–µ–Ω–∞ –ü–£–°–¢–û–¢–ù–ê–Ø –∫–∞—Ä—Ç–∞ ${card.name}!!!!`;
                    }
                    
                    addChatMessage(message, card.color, card.mutation);
                    
                    // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ –≥–ª–æ–±–∞–ª—å–Ω—ã–π —á–∞—Ç
                    if (socket) {
                        const chatMessage = {
                            type: 'chat_message',
                            text: message,
                            mutation: card.mutation
                        };
                        socket.send(JSON.stringify(chatMessage));
                    }
                }
            });
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∫–æ–ª–ª–µ–∫—Ü–∏—é –∏ –ø—Ä–æ–∫—Ä—É—á–∏–≤–∞–µ–º –∫ –Ω–æ–≤—ã–º –∫–∞—Ä—Ç–∞–º
            setTimeout(() => {
                updateCollection();
                
                // –ü—Ä–æ–∫—Ä—É—á–∏–≤–∞–µ–º –∫–æ–ª–ª–µ–∫—Ü–∏—é –∫ –ø–æ—Å–ª–µ–¥–Ω–∏–º –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã–º –∫–∞—Ä—Ç–∞–º
                collection.scrollTo({
                    top: collection.scrollHeight,
                    behavior: 'smooth'
                });
            }, 1000);
        });
        
        // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω –ø–æ –∫–ª–∏–∫—É –Ω–∞ –∑–∞—Ç–µ–º–Ω–µ–Ω–Ω—É—é –æ–±–ª–∞—Å—Ç—å
        cardModal.addEventListener('click', function(e) {
            if (e.target === cardModal) {
                if (newCard.classList.contains('flipped')) {
                    cardModal.style.display = 'none';
                }
            }
        });
        
        bigPackModal.addEventListener('click', function(e) {
            if (e.target === bigPackModal) {
                // –ó–∞–∫—Ä—ã–≤–∞–µ–º —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –≤—Å–µ –∫–∞—Ä—Ç—ã –æ—Ç–∫—Ä—ã—Ç—ã
                const allFlipped = Array.from(document.querySelectorAll('.multi-card'))
                    .every(card => card.classList.contains('flipped'));
                
                if (allFlipped) {
                    bigPackModal.style.display = 'none';
                } else {
                    // –ï—Å–ª–∏ –Ω–µ –≤—Å–µ –∫–∞—Ä—Ç—ã –æ—Ç–∫—Ä—ã—Ç—ã, –æ—Ç–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ
                    document.querySelectorAll('.multi-card').forEach(card => {
                        card.classList.add('flipped');
                    });
                }
            }
        });
        
        megaPackModal.addEventListener('click', function(e) {
            if (e.target === megaPackModal) {
                // –ó–∞–∫—Ä—ã–≤–∞–µ–º —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –≤—Å–µ –∫–∞—Ä—Ç—ã –æ—Ç–∫—Ä—ã—Ç—ã
                const allFlipped = Array.from(document.querySelectorAll('.mega-card'))
                    .every(card => card.classList.contains('flipped'));
                
                if (allFlipped) {
                    megaPackModal.style.display = 'none';
                } else {
                    // –ï—Å–ª–∏ –Ω–µ –≤—Å–µ –∫–∞—Ä—Ç—ã –æ—Ç–∫—Ä—ã—Ç—ã, –æ—Ç–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ
                    document.querySelectorAll('.mega-card').forEach(card => {
                        card.classList.add('flipped');
                    });
                }
            }
        });
        //–∫—Ä—É—Ç–æ–π
        // –°–±—Ä—Å –∫–æ–ª–ª–µ–∫—Ü–∏–∏
        resetBtn.addEventListener('click', function() {
            if (confirm("–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —Å–±—Ä–æ—Å–∏—Ç—å –≤—Å—é –∫–æ–ª–ª–µ–∫—Ü–∏—é?")) {
                userCollection = [];
                saveCollection();
                updateAccountValue();
                updateCollection();
            }
        });
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤—Ö–æ–¥–∞ –≤ –∏–≥—Ä—É
        function handleLogin() {
            const name = playerNameInput.value.trim();
            
            if (name.length < 3 || name.length > 20) {
                alert('–ò–º—è –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –æ—Ç 3 –¥–æ 20 —Å–∏–º–≤–æ–ª–æ–≤');
                return;
            }
            
            playerName = name;
            localStorage.setItem('playerName', playerName);
            loginModal.style.display = 'none';
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –∏–≥—Ä—É
            initGame();
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–≥—Ä—ã –ø–æ—Å–ª–µ –≤—Ö–æ–¥–∞
        function initGame() {
            updateRarityInfo();
            updateCollection();
            updateAccountValue();
            updatePlayerCounters();
            updateTradeSelects();
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –±—É—Å—Ç—ã –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
            checkSpecialEvents();
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —Ç–∞–π–º–µ—Ä –º–µ–≥–∞ –ø–∞–∫–∞
            initMegaPackTimer();
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º WebSocket —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
            initWebSocket();
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.addEventListener('load', function() {
            // –ï—Å–ª–∏ –∏–º—è –∏–≥—Ä–æ–∫–∞ —É–∂–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ, —Å—Ä–∞–∑—É –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –∏–≥—Ä—É
            if (playerName) {
                loginModal.style.display = 'none';
                initGame();
            }
            
            // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –∫–Ω–æ–ø–∫–∏ –≤—Ö–æ–¥–∞
            document.getElementById('loginButton').addEventListener('click', handleLogin);
            
            // –¢–∞–∫–∂–µ –¥–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –≤–≤–æ–¥–∞ –ø–æ –Ω–∞–∂–∞—Ç–∏—é Enter
            playerNameInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    handleLogin();
                }
            });
        });
    </script>
</body>
    </html>
